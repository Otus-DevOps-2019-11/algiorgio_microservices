# algiorgio_microservices
algiorgio microservices repository

------------

#### docker-2. этапы работ:
1. В docker-1.log добавлено описание разницы между ```docker inspect <u_container_id>``` и ```docker inspect <u_image_id>```
2. Создан новый проект GCP - ```docker```
3. Проект ```docker``` инициализирован
4. Для учетной записи Google, к которой привязан GCP проект ```docker``` произведена связка с приложением ```glcoud```
5. На рабочую машину устанолен ```docker-machine```
6. На платформе GCP через ```docker-machine``` с указанными параметрами создана виртуальная машина ```docker-host```
7. Произведено переключение Docker на работу со вновь созданным GCP-хостом ```docker-host```
8. В рамках практической работы №15 в директории ```docker-monolith``` создан текстовый файл ```Dockerfile``` для создания на его основе ```docker-image```
9. Для создания ```docker-image``` для работы приложения в директори ```docker-monolith``` также соданы файлы mongod.conf, db_config, start.sh работа с которыми осуществляется в ```Dockerfile```
10. Осуществлена сборка образа ```reddit:latest```
11. На основе полученного образа ```reddit:latest``` на ```docker-host``` запущен контейнер
12. Утилитой ```gcloud``` добавлен правило для firewall в GCP для работы приложения на порту 9292
13. Произведена регистрация в ```Docker Hub```. Username: algiorgio
14. Созданный docker-image загружен в ```Docker Hub```


#### Задание со *

1. Инструменты для сборки образа расположены в директории ```docker-monolith/infra/image```:
   - для сборки образа исползуется packer и исполняемым файлом ```docker.json``` и var-файлом ```variables.json```
   - в качетсве provisioner'а используется ansible-плейбук ```playbook.yml```, в котором осуществляется процесс установки Docker в образ
   - запуск инструмента осуществляется скриптом build.sh в указанной директории

2. Инструменты для создания инфраструктуры расположены в директории ```docker-monolith/infra/infrastructure```:
   - для создания инфраструктуры используется terraform
   - при создании экземпляров виртуальных машин используется образ, созданный на шаге 1
   - запуск инструмента осуществляется скриптом build.sh в указанной директории

3. Инструменты для запуска Docker-контейнера расположены в директории ```docker-monolith/infra/container```:
   - для запуска docker-контейнера используется ansible-плейбук ```playbook.yml```
   - в качетсве образа для docker-контейнера используется образ ```algiorgio/otus-reddit:1.0```, созданный в основной части практической работы №15
   - в dynamic inventory ```inventory.gcp.yml``` для объединения хостов в группу используется имя, указанное таковым для ресурса ```google_compute_instance``` при определении переменной файла ```terraform.tfvars``` при создании инфраструктуры (пункт 2)
   - запуск инструмента осуществляется скриптом build.sh в указанной директории
   - для запуска требуются библиотеки для виртуального окружения, указанные в requirements.txt
